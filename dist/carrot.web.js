var carrot=function(t){var e={};function o(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,o),i.l=!0,i.exports}return o.m=t,o.c=e,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)o.d(n,i,function(e){return t[e]}.bind(null,i));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=29)}([function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PoolNodeType=e.NodeType=void 0,function(t){t[t.INPUT=0]="INPUT",t[t.HIDDEN=1]="HIDDEN",t[t.OUTPUT=2]="OUTPUT"}(e.NodeType||(e.NodeType={})),function(t){t[t.MAX_POOLING=0]="MAX_POOLING",t[t.AVG_POOLING=1]="AVG_POOLING",t[t.MIN_POOLING=2]="MIN_POOLING"}(e.PoolNodeType||(e.PoolNodeType={}))},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ALL_ACTIVATIONS=e.GAUSSIAN=e.Sinc=e.Sinusiod=e.SiLU=e.BentIdentity=e.SoftPlus=e.LeakyRELU=e.RELU=e.SoftSign=e.ArSinH=e.ArcTan=e.SQNL=e.TANH=e.Logistic=e.BinaryStep=e.Identitiy=void 0;const n=(t,e=!1)=>e?1:t;e.Identitiy=n;const i=(t,e=!1)=>e||t<0?0:1;e.BinaryStep=i;const s=(t,e=!1)=>{const o=Math.exp(-t);return e?1/(1+o)*(1-1/(1+o)):1/(1+o)};e.Logistic=s;const r=(t,e=!1)=>e?1-Math.pow(Math.tanh(t),2):Math.tanh(t);e.TANH=r;const a=(t,e=!1)=>e?t>2?0:t>=0?1-t/2:t>=-2?1+t/2:0:t>2?1:t>=0?t-Math.pow(t/2,2):t>=-2?t+Math.pow(t/2,2):-1;e.SQNL=a;const c=(t,e=!1)=>e?1/(Math.pow(t,2)+1):Math.atan(t);e.ArcTan=c;const h=(t,e=!1)=>e?1/Math.pow(Math.pow(t,2)+1,.5):Math.asinh(t);e.ArSinH=h;const u=(t,e=!1)=>e?1/Math.pow(1+Math.abs(t),2):t/(1+Math.abs(t));e.SoftSign=u;const d=(t,e=!1)=>e?t>0?1:0:t>0?t:0;e.RELU=d;const l=(t,e=!1)=>e?t>0?1:.01:t>0?t:.01*t;e.LeakyRELU=l;const p=(t,e=!1)=>e?1/(1+Math.exp(-t)):Math.log(1+Math.exp(t));e.SoftPlus=p;const f=(t,e=!1)=>e?t/(2*Math.pow(Math.pow(t,2)+1,.5))+1:(Math.pow(Math.pow(t,2)+1,.5)-1)/2+t;e.BentIdentity=f;const g=(t,e=!1)=>{const o=Math.exp(-t);return e?(1+o+t*o)/Math.pow(1+o,2):t/(1+o)};e.SiLU=g;const m=(t,e=!1)=>e?Math.cos(t):Math.sin(t);e.Sinusiod=m;const y=(t,e=!1)=>e?0===t?0:Math.cos(t)/t-Math.sin(t)/Math.pow(t,2):0===t?1:Math.sin(t)/t;e.Sinc=y;const N=(t,e=!1)=>e?-2*t*Math.exp(-Math.pow(t,2)):1/Math.exp(Math.pow(t,2));e.GAUSSIAN=N,e.ALL_ACTIVATIONS=[n,i,s,r,a,c,h,u,d,l,p,f,g,m,y,N]},function(t,e,o){"use strict";function n(t,e){return Math.floor(Math.random()*(e-t)+t)}function i(t){if(0===t.length)throw new RangeError;let e=0;for(const o of t)e+=o;return e}Object.defineProperty(e,"__esModule",{value:!0}),e.pairing=e.generateGaussian=e.avg=e.sum=e.min=e.minValueIndex=e.maxValueIndex=e.max=e.shuffle=e.removeFromArray=e.randBoolean=e.randDouble=e.randInt=e.pickRandom=void 0,e.pickRandom=function t(e){if(Array.isArray(e)){if(0===e.length)throw new RangeError("Cannot pick from an empty array");return e[n(0,e.length)]}return t(Array.from(e))},e.randInt=n,e.randDouble=function(t=0,e=1){return Math.random()*(e-t)+t},e.randBoolean=function(){return Math.random()>=.5},e.removeFromArray=function(t,e){const o=t.indexOf(e);return-1!==o&&(t.splice(o,1),!0)},e.shuffle=function(t){for(let e=t.length-1;e>0;e--){const o=n(0,e),i=t[e];t[e]=t[o],t[o]=i}},e.max=function(t){if(0===t.length)throw new RangeError;let e=t[0];for(let o=1;o<t.length;o++)t[o]>e&&(e=t[o]);return e},e.maxValueIndex=function(t){if(0===t.length)throw new RangeError;let e=t[0],o=0;for(let n=1;n<t.length;n++)t[n]>e&&(e=t[n],o=n);return o},e.minValueIndex=function(t){if(0===t.length)throw new RangeError;let e=t[0],o=0;for(let n=1;n<t.length;n++)t[n]<e&&(e=t[n],o=n);return o},e.min=function(t){if(0===t.length)throw new RangeError;let e=t[0];for(let o=1;o<t.length;o++)t[o]<e&&(e=t[o]);return e},e.avg=function(t){return i(t)/t.length},e.sum=i,e.generateGaussian=function(t=0,e=2){let o=0;for(let t=0;t<10;t++)o+=Math.random();return e*o/10+t-.5*e},e.pairing=function(t,e){if(t<0||e<0)throw new RangeError("Should be a positive integer!");return.5*(t+e)*(t+e+1)+e}},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ConnectionType=void 0,function(t){t[t.NO_CONNECTION=0]="NO_CONNECTION",t[t.ALL_TO_ALL=1]="ALL_TO_ALL",t[t.ONE_TO_ONE=2]="ONE_TO_ONE",t[t.POOLING=3]="POOLING"}(e.ConnectionType||(e.ConnectionType={}))},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Layer=void 0;const n=o(3),i=o(10);class s{constructor(t){this.outputSize=t,this.nodes=[],this.inputNodes=new Set,this.outputNodes=new Set,this.connections=[],this.gates=[]}static connect(t,e,o=n.ConnectionType.ALL_TO_ALL,i=1){if(o===n.ConnectionType.NO_CONNECTION)throw new ReferenceError("Cannot connect with 'NO_CONNECTION' connection type");const r=Array.from(t instanceof s?t.outputNodes:t),a=Array.from(e instanceof s?e.inputNodes:e);if(0===a.length)throw new ReferenceError("Target from has no input nodes!");if(0===r.length)throw new ReferenceError("This from has no output nodes!");const c=[];if(o===n.ConnectionType.ALL_TO_ALL)r.forEach(t=>{a.forEach(e=>{c.push(t.connect(e,i))})});else if(o===n.ConnectionType.ONE_TO_ONE){if(r.length!==a.length)throw new RangeError("Can't connect one to one! Number of output nodes from are unequal number of incoming nodes from next layer!");for(let t=0;t<r.length;t++)c.push(r[t].connect(a[t],i))}else if(o===n.ConnectionType.POOLING){const t=a.length/r.length;c.push(...r.map((e,o)=>e.connect(a[Math.floor(o*t)],i)))}return c}static gate(t,e,o){const n=[];switch(o){case i.GatingType.INPUT:{const o=Array.from(new Set(e.map(t=>t.to)));for(let i=0;i<o.length;i++){const s=o[i],r=t[i%t.length];s.incoming.forEach(t=>{e.includes(t)&&(r.addGate(t),n.push(t))})}break}case i.GatingType.SELF:{const o=Array.from(new Set(e.map(t=>t.from)));for(let i=0;i<o.length;i++)e.includes(o[i].selfConnection)&&(t[i%t.length].addGate(o[i].selfConnection),n.push(o[i].selfConnection));break}case i.GatingType.OUTPUT:{const o=Array.from(new Set(e.map(t=>t.from)));for(let i=0;i<o.length;i++){const s=o[i],r=t[i%t.length];s.outgoing.forEach(t=>{e.includes(t)&&(r.addGate(t),n.push(t))})}break}}return n}}e.Layer=s},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Node=void 0;const n=o(1),i=o(14),s=o(0),r=o(7),a=o(2);e.Node=class{constructor(t=s.NodeType.HIDDEN){this.type=t,this.bias=a.randDouble(-1,1),this.squash=n.Logistic,this.activation=0,this.derivativeState=1,this.state=0,this.prevState=0,this.mask=1,this.id=-1,this.deltaBiasPrevious=0,this.deltaBiasTotal=0,this.incoming=new Set,this.outgoing=new Set,this.gated=new Set,this.selfConnection=new i.Connection(this,this,0),this.errorResponsibility=0,this.errorProjected=0,this.errorGated=0,this.index=NaN}fromJSON(t){return this.bias=t.bias,this.type=t.type,this.squash=n.ALL_ACTIVATIONS.filter(e=>e.name===t.squash)[0],this.mask=t.mask,this.index=t.index,this.errorResponsibility=t.errorResponsibility,this.errorProjected=t.errorProjected,this.errorGated=t.errorGated,this.deltaBiasPrevious=t.deltaBiasPrevious,this.deltaBiasTotal=t.deltaBiasTotal,this.derivativeState=t.derivativeState,this.state=t.state,this.prevState=t.prevState,this.activation=t.activation,this}clear(){this.incoming.forEach(t=>{t.eligibility=0,t.xTrace.clear()}),this.gated.forEach(t=>t.gain=0),this.errorResponsibility=this.errorProjected=this.errorGated=0,this.prevState=this.state=this.activation=0}mutateBias(t=new r.ModBiasMutation){this.bias+=a.randDouble(t.min,t.max)}mutateActivation(t=Object.values(n.ALL_ACTIVATIONS)){const e=t.filter(t=>t!==this.squash);e.length>0&&(this.squash=a.pickRandom(e))}isProjectedBy(t){return t===this?0!==this.selfConnection.weight:Array.from(this.incoming).map(t=>t.from).includes(t)}isProjectingTo(t){return t===this?0!==this.selfConnection.weight:Array.from(this.outgoing).map(t=>t.to).includes(t)}addGate(t){this.gated.add(t),t.gateNode=this}removeGate(t){this.gated.delete(t),t.gateNode=null,t.gain=1}connect(t,e=1,o=!1){if(t===this)return this.selfConnection.weight=e,this.selfConnection;if(this.isProjectingTo(t))throw new ReferenceError("There is already a connection!");{const n=new i.Connection(this,t,e);return this.outgoing.add(n),t.incoming.add(n),o&&t.connect(this),n}}disconnect(t,e=!1){if(t===this)return this.selfConnection.weight=0,this.selfConnection;const o=Array.from(this.outgoing).filter(e=>e.to===t);if(0===o.length)throw new Error("No Connection found");const n=o[0];return this.outgoing.delete(n),n.to.incoming.delete(n),void 0!==n.gateNode&&null!==n.gateNode&&n.gateNode.removeGate(n),e&&t.disconnect(this),n}propagate(t,e={}){var o,n,i;e.momentum=null!==(o=e.momentum)&&void 0!==o?o:0,e.rate=null!==(n=e.rate)&&void 0!==n?n:.3,e.update=null===(i=e.update)||void 0===i||i,void 0!==t&&Number.isFinite(t)?this.errorResponsibility=this.errorProjected=t-this.activation:(this.errorProjected=0,this.outgoing.forEach(t=>{this.errorProjected+=t.to.errorResponsibility*t.weight*t.gain}),this.errorProjected*=this.derivativeState,this.errorGated=0,this.gated.forEach(t=>{let e;e=t.to.selfConnection.gateNode===this?t.to.prevState+t.weight*t.from.activation:t.weight*t.from.activation,this.errorGated+=t.to.errorResponsibility*e}),this.errorGated*=this.derivativeState,this.errorResponsibility=this.errorProjected+this.errorGated),this.incoming.forEach(t=>{var o,n;let i=this.errorProjected*t.eligibility;t.xTrace.forEach((t,e)=>i+=e.errorResponsibility*t),t.deltaWeightsTotal+=(null!==(o=e.rate)&&void 0!==o?o:.3)*i*this.mask,e.update&&(t.deltaWeightsTotal+=(null!==(n=e.momentum)&&void 0!==n?n:0)*t.deltaWeightsPrevious,t.weight+=t.deltaWeightsTotal,t.deltaWeightsPrevious=t.deltaWeightsTotal,t.deltaWeightsTotal=0)}),this.deltaBiasTotal+=e.rate*this.errorResponsibility,e.update&&(this.deltaBiasTotal+=e.momentum*this.deltaBiasPrevious,this.bias+=this.deltaBiasTotal,this.deltaBiasPrevious=this.deltaBiasTotal,this.deltaBiasTotal=0)}activate(t,e=!0){if(void 0!==t)return this.activation=t;if(this.isInputNode())throw new ReferenceError("There is no input given to an input node!");if(e){this.prevState=this.state,this.state=this.selfConnection.gain*this.selfConnection.weight*this.state+this.bias,this.incoming.forEach(t=>{this.state+=t.from.activation*t.weight*t.gain}),this.activation=this.squash(this.state,!1)*this.mask,this.derivativeState=this.squash(this.state,!0);const t=[],e=[];return this.gated.forEach(o=>{o.gain=this.activation;const n=t.indexOf(o.to);n>-1?e[n]+=o.weight*o.from.activation:(t.push(o.to),o.to.selfConnection.gateNode===this?e.push(o.weight*o.from.activation+o.to.prevState):e.push(o.weight*o.from.activation))}),this.incoming.forEach(o=>{var n;o.eligibility=this.selfConnection.gain*this.selfConnection.weight*o.eligibility+o.from.activation*o.gain;for(let i=0;i<t.length;i++){const s=t[i],r=e[i];o.xTrace.has(s)?o.xTrace.set(s,s.selfConnection.gain*s.selfConnection.weight*(null!==(n=o.xTrace.get(s))&&void 0!==n?n:0)+this.derivativeState*o.eligibility*r):o.xTrace.set(s,this.derivativeState*o.eligibility*r)}}),this.activation}return this.isInputNode()?this.activation=0:(this.state=this.selfConnection.gain*this.selfConnection.weight*this.state+this.bias,this.incoming.forEach(t=>this.state+=t.from.activation*t.weight*t.gain),this.activation=this.squash(this.state,!1),this.gated.forEach(t=>t.gain=this.activation),this.activation)}toJSON(){return{bias:this.bias,type:this.type,squash:this.squash.name,mask:this.mask,index:this.index,errorResponsibility:this.errorResponsibility,errorProjected:this.errorProjected,errorGated:this.errorGated,deltaBiasPrevious:this.deltaBiasPrevious,deltaBiasTotal:this.deltaBiasTotal,derivativeState:this.derivativeState,state:this.state,prevState:this.prevState,activation:this.activation}}isInputNode(){return this.type===s.NodeType.INPUT}isHiddenNode(){return this.type===s.NodeType.HIDDEN}isOutputNode(){return this.type===s.NodeType.OUTPUT}setBias(t){return this.bias=t,this}setActivationType(t){return this.squash=t,this}}},function(t,e,o){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,o,n){void 0===n&&(n=o),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[o]}})}:function(t,e,o,n){void 0===n&&(n=o),t[n]=e[o]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var o in t)"default"!==o&&Object.hasOwnProperty.call(t,o)&&n(e,t,o);return i(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.Network=void 0;const r=s(o(30)),a=o(9),c=o(2),h=o(14),u=o(5),d=o(0),l=o(7);class p{constructor(t,e,o=!1){this.inputSize=t,this.outputSize=e,this.nodes=[],this.connections=new Set,this.gates=new Set,this.score=void 0,this.adjustedFitness=0;for(let e=0;e<t;e++)this.nodes.push(new u.Node(d.NodeType.INPUT));for(let t=0;t<e;t++)this.nodes.push(new u.Node(d.NodeType.OUTPUT));if(!o)for(let t=0;t<this.inputSize;t++)for(let e=this.inputSize;e<this.outputSize+this.inputSize;e++){const o=(Math.random()-.5)*this.inputSize*Math.sqrt(2/this.inputSize);this.connect(this.nodes[t],this.nodes[e],o)}}static fromJSON(t){const e=new p(t.inputSize,t.outputSize);return e.nodes=[],e.connections.clear(),t.nodes.map(t=>(new u.Node).fromJSON(t)).forEach(t=>e.nodes[t.index]=t),t.connections.forEach(t=>{const o=h.Connection.fromJSON(t,e.nodes);e.connections.add(o),null!==t.gateNodeIndex&&e.addGate(e.nodes[t.gateNodeIndex],o)}),e}static crossover(t,e){var o,n;if(t.inputSize!==e.inputSize||t.outputSize!==e.outputSize)throw new Error("Networks don`t have the same input/output size!");const i=new p(t.inputSize,t.outputSize,!0);i.connections.clear(),i.nodes=[];const s=null!==(o=t.score)&&void 0!==o?o:0,r=null!==(n=e.score)&&void 0!==n?n:0;let a;if(s===r){const o=Math.max(t.nodes.length,e.nodes.length),n=Math.min(t.nodes.length,e.nodes.length);a=c.randInt(n,o+1)}else a=s>r?t.nodes.length:e.nodes.length;const h=t.inputSize,l=t.outputSize;for(let e=0;e<t.nodes.length;e++)t.nodes[e].index=e;for(let t=0;t<e.nodes.length;t++)e.nodes[t].index=t;for(let o=0;o<a;o++){let n,s=null;if(o<h){s=d.NodeType.INPUT;const i=c.randBoolean()?t:e;let r=-1,a=-1;for(;r<o;){if(a++>=i.nodes.length)throw RangeError("something is wrong with the size of the input");i.nodes[a].isInputNode()&&r++}n=i.nodes[a]}else if(o<h+l){s=d.NodeType.OUTPUT;const i=c.randBoolean()?t:e;let r=-1,a=-1;for(;r<o-h;){if(a++,a>=i.nodes.length)throw RangeError("something is wrong with the size of the output");i.nodes[a].isOutputNode()&&r++}n=i.nodes[a]}else{let i;s=d.NodeType.HIDDEN,i=o>=t.nodes.length?e:o>=e.nodes.length||c.randBoolean()?t:e,n=c.pickRandom(i.nodes)}const r=new u.Node(s);r.bias=n.bias,r.squash=n.squash,i.nodes.push(r)}const f=[],g=[];t.connections.forEach(t=>{f[c.pairing(t.from.index,t.to.index)]=t.toJSON()}),e.connections.forEach(t=>{g[c.pairing(t.from.index,t.to.index)]=t.toJSON()});const m=[],y=Object.keys(f),N=Object.keys(g);for(let t=y.length-1;t>=0;t--)void 0!==g[parseInt(y[t])]?(m.push(c.randBoolean()?f[parseInt(y[t])]:g[parseInt(y[t])]),g[parseInt(y[t])]=void 0):s>=r&&m.push(f[parseInt(y[t])]);return r>=s&&N.map(t=>parseInt(t)).map(t=>g[t]).filter(t=>void 0!==t).forEach(t=>m.push(t)),m.forEach(t=>{if(void 0!==t&&t.toIndex<a&&t.fromIndex<a){const e=i.nodes[t.fromIndex],o=i.nodes[t.toIndex],n=i.connect(e,o,t.weight);null!==t.gateNodeIndex&&t.gateNodeIndex<a&&i.addGate(i.nodes[t.gateNodeIndex],n)}}),i}deepCopy(){return p.fromJSON(this.toJSON())}connect(t,e,o=0){const n=t.connect(e,o);return this.connections.add(n),n}activate(t,e={}){var o,n;if(t.length!==this.inputSize)throw new RangeError("Input size of dataset is different to network input size!");return e.dropoutRate=null!==(o=e.dropoutRate)&&void 0!==o?o:0,e.trace=null===(n=e.trace)||void 0===n||n,this.nodes.filter(t=>t.isInputNode()).forEach((o,n)=>o.activate(t[n],e.trace)),this.nodes.filter(t=>t.isHiddenNode()).forEach(t=>{e.dropoutRate&&(t.mask=Math.random()>=e.dropoutRate?1:0),t.activate(void 0,e.trace)}),this.nodes.filter(t=>t.isOutputNode()).map(t=>t.activate(void 0,e.trace))}propagate(t,e={}){var o,n,i;if(e.rate=null!==(o=e.rate)&&void 0!==o?o:.3,e.momentum=null!==(n=e.momentum)&&void 0!==n?n:0,e.update=null!==(i=e.update)&&void 0!==i&&i,t.length!==this.outputSize)throw new Error("Output target length should match network output length");this.nodes.filter(t=>t.isOutputNode()).forEach((o,n)=>o.propagate(t[n],e));for(let t=this.nodes.length-1;t>=0;t--)this.nodes[t].isHiddenNode()&&this.nodes[t].propagate(void 0,e);this.nodes.filter(t=>t.isInputNode()).forEach(t=>t.propagate(void 0,e))}clear(){this.nodes.forEach(t=>t.clear())}disconnect(t,e){return this.connections.forEach(o=>{o.from===t&&o.to===e&&(null!==o.gateNode&&this.removeGate(o),this.connections.delete(o))}),t.disconnect(e)}addGate(t,e){if(-1===this.nodes.indexOf(t))throw new ReferenceError("This node is not part of the network!");null===e.gateNode&&(t.addGate(e),this.gates.add(e))}removeGate(t){if(!this.gates.has(t))throw new Error("This connection is not gated!");this.gates.delete(t),null!==t.gateNode&&t.gateNode.removeGate(t)}removeNode(t,e=!0){if(!this.nodes.includes(t))throw new ReferenceError("This node does not exist in the network!");this.disconnect(t,t);const o=[],n=[],i=[],s=[];for(t.incoming.forEach(i=>{e&&null!==i.gateNode&&i.gateNode!==t&&n.push(i.gateNode),o.push(i.from),this.disconnect(i.from,t)}),t.outgoing.forEach(o=>{e&&null!==o.gateNode&&o.gateNode!==t&&n.push(o.gateNode),i.push(o.to),this.disconnect(t,o.to)}),o.forEach(t=>{i.forEach(e=>{t.isProjectingTo(e)||s.push(this.connect(t,e))})});n.length>0&&s.length>0;){const t=n.shift();if(void 0===t)continue;const e=c.pickRandom(s);this.addGate(t,e),c.removeFromArray(s,e)}t.gated.forEach(this.removeGate),c.removeFromArray(this.nodes,t)}mutate(t,e){t.mutate(this,e)}mutateRandom(t=l.ALL_INSTINCT_MUTATIONS,e={}){0!==t.length&&this.mutate(c.pickRandom(t),e)}train(t){if(t.dataset[0].input.length!==this.inputSize||t.dataset[0].output.length!==this.outputSize)throw new Error("Dataset input/output size should be same as network input/output size!");const e=Date.now();if(t.iterations<=0&&t.error<=0)throw new Error("At least one of the following options must be specified: error, iterations");let o,n,i,s;t.crossValidateTestSize>0?(o=Math.ceil((1-t.crossValidateTestSize)*t.dataset.length),n=t.dataset.slice(0,o),i=t.dataset.slice(o)):(n=t.dataset,i=[]);let r=0,a=1;for(;a>t.error&&(t.iterations<=0||r<t.iterations);)r++,s=t.rate.calc(r),a=this.trainEpoch({dataset:n,batchSize:t.batchSize,trainingRate:s,momentum:t.momentum,loss:t.loss,dropoutRate:t.dropout}),t.clear&&this.clear(),t.crossValidateTestSize>0&&(a=this.test(i,t.loss),t.clear&&this.clear()),t.shuffle&&c.shuffle(t.dataset),t.log>0&&r%t.log==0&&console.log("iteration number",r,"error",a,"training rate",s),t.schedule&&r%t.schedule.iterations==0&&t.schedule.function(a,r);return t.clear&&this.clear(),{error:a,iterations:r,time:Date.now()-e}}test(t,e=a.MSELoss){let o=0;for(const n of t){const t=n.input;o+=e(n.output,this.activate(t,{trace:!1}))}return o/t.length}toJSON(){const t={nodes:[],connections:[],inputSize:this.inputSize,outputSize:this.outputSize};for(let t=0;t<this.nodes.length;t++)this.nodes[t].index=t;return this.nodes.forEach(e=>{t.nodes.push(e.toJSON()),0!==e.selfConnection.weight&&t.connections.push(e.selfConnection.toJSON())}),this.connections.forEach(e=>{t.connections.push(e.toJSON())}),t}distance(t,e,o,n){for(let t=0;t<this.nodes.length;t++)this.nodes[t].index=t;for(let e=0;e<t.nodes.length;e++)t.nodes[e].index=e;let i=0,s=0;const a=Array.from(this.connections).filter(t=>void 0!==t),c=Array.from(t.connections).filter(t=>void 0!==t);r.sort(a,(t,e)=>t.getInnovationID()-e.getInnovationID()),r.sort(c,(t,e)=>t.getInnovationID()-e.getInnovationID());if(a[a.length-1].getInnovationID()<c[c.length-1].getInnovationID())return t.distance(this,e,o,n);let h=0,u=0,d=0;for(;i<a.length&&s<c.length;){const t=a[i],e=c[s];if(void 0===t||void 0===e)throw Error("HERE");t.getInnovationID()===e.getInnovationID()?(i++,s++,u+=Math.abs(t.weight-e.weight),d++):i>s?(s++,h++):(i++,h++)}u/=d;const l=this.connections.size-i;let p=Math.max(this.connections.size,t.connections.size);return p<20&&(p=1),e*l/p+o*h/p+n*u}trainEpoch(t){let e=0;for(let o=0;o<t.dataset.length;o++){const n=t.dataset[o].input,i=t.dataset[o].output,s=(o+1)%t.batchSize==0||o+1===t.dataset.length,r=this.activate(n,{dropoutRate:t.dropoutRate});this.propagate(i,{rate:t.trainingRate,momentum:t.momentum,update:s}),e+=t.loss(i,r)}return e/t.dataset.length}}e.Network=p},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ONLY_STRUCTURE_INSTINCT_MUTATION=e.NO_STRUCTURE_INSTINCT_MUTATIONS=e.FEEDFORWARD_INSTINCT_MUTATIONS=e.ALL_INSTINCT_MUTATIONS=e.SwapNodesMutation=e.SubBackConnectionMutation=e.AddBackConnectionMutation=e.SubGateMutation=e.AddGateMutation=e.SubSelfConnectionMutation=e.AddSelfConnectionMutation=e.ModActivationMutation=e.ModBiasMutation=e.ModWeightMutation=e.SubConnectionMutation=e.AddConnectionMutation=e.SubNodeMutation=e.AddNodeMutation=void 0;const n=o(15),i=o(5),s=o(2),r=o(0);class a extends n.Mutation{constructor(t=!0){super(),this.randomActivation=t}mutate(t,e={}){if(void 0!==e.maxNodes&&t.nodes.length>=e.maxNodes)return;const o=new i.Node(r.NodeType.HIDDEN);this.randomActivation&&o.mutateActivation();const n=s.pickRandom(Array.from(t.connections)),a=n.from,c=n.to;t.disconnect(a,c);const h=Math.max(t.inputSize,1+t.nodes.indexOf(a));t.nodes.splice(h,0,o);const u=t.connect(a,o,1),d=t.connect(o,c,n.weight);null!==n.gateNode&&(s.randBoolean()?t.addGate(n.gateNode,u):t.addGate(n.gateNode,d))}}e.AddNodeMutation=a;class c extends n.Mutation{constructor(t=!0){super(),this.keepGates=t}mutate(t){const e=t.nodes.filter(t=>void 0!==t&&t.isHiddenNode());e.length>0&&t.removeNode(s.pickRandom(e),this.keepGates)}}e.SubNodeMutation=c;class h extends n.Mutation{mutate(t,e={}){if(void 0!==e.maxConnections&&t.connections.size>=e.maxConnections)return;const o=[];for(let e=0;e<t.nodes.length-t.outputSize;e++){const n=t.nodes[e];for(let i=Math.max(e+1,t.inputSize);i<t.nodes.length;i++){const e=t.nodes[i];n.isProjectingTo(e)||o.push([n,e])}}if(o.length>0){const e=s.pickRandom(o);t.connect(e[0],e[1])}}}e.AddConnectionMutation=h;class u extends n.Mutation{mutate(t){const e=Array.from(t.connections).filter(t=>t.from.outgoing.size>1).filter(t=>t.to.incoming.size>1).filter(e=>t.nodes.indexOf(e.to)>t.nodes.indexOf(e.from));if(e.length>0){const o=s.pickRandom(e);t.disconnect(o.from,o.to)}}}e.SubConnectionMutation=u;class d extends n.Mutation{constructor(t=-1,e=1){super(),this.min=t,this.max=e}mutate(t){s.pickRandom(Array.from(t.connections)).weight+=s.randDouble(this.min,this.max)}}e.ModWeightMutation=d;class l extends n.Mutation{constructor(t=-1,e=1){super(),this.min=t,this.max=e}mutate(t){s.pickRandom(t.nodes.filter(t=>!t.isInputNode())).mutateBias(this)}}e.ModBiasMutation=l;class p extends n.Mutation{constructor(t=!1){super(),this.mutateOutput=t}mutate(t,e={}){const o=this.mutateOutput?t.nodes.filter(t=>!t.isInputNode()):t.nodes.filter(t=>t.isHiddenNode());o.length>0&&s.pickRandom(o).mutateActivation(e.allowedActivations)}}e.ModActivationMutation=p;class f extends n.Mutation{mutate(t){const e=t.nodes.filter(t=>!t.isInputNode()).filter(t=>0===t.selfConnection.weight);if(e.length>0){const o=s.pickRandom(e);t.connect(o,o)}}}e.AddSelfConnectionMutation=f;class g extends n.Mutation{mutate(t){const e=Array.from(t.connections).filter(t=>t.from===t.to);if(e.length>0){const o=s.pickRandom(e);t.disconnect(o.from,o.to)}}}e.SubSelfConnectionMutation=g;class m extends n.Mutation{mutate(t,e={}){if(void 0!==e.maxGates&&t.gates.size>=e.maxGates)return;const o=Array.from(t.connections).filter(t=>null===t.gateNode);if(o.length>0){const e=s.pickRandom(t.nodes.filter(t=>!t.isInputNode())),n=s.pickRandom(o);t.addGate(e,n)}}}e.AddGateMutation=m;class y extends n.Mutation{mutate(t){t.gates.size>0&&t.removeGate(s.pickRandom(Array.from(t.gates)))}}e.SubGateMutation=y;class N extends n.Mutation{mutate(t){const e=[];for(let o=t.inputSize;o<t.nodes.length;o++){const n=t.nodes[o];for(let i=t.inputSize;i<o;i++){const o=t.nodes[i];n.isProjectingTo(o)||e.push([n,o])}}if(e.length>0){const o=s.pickRandom(e);t.connect(o[0],o[1])}}}e.AddBackConnectionMutation=N;class v extends n.Mutation{mutate(t){const e=Array.from(t.connections).filter(t=>t.from.outgoing.size>1).filter(t=>t.to.incoming.size>1).filter(e=>t.nodes.indexOf(e.from)>t.nodes.indexOf(e.to));if(e.length>0){const o=s.pickRandom(e);t.disconnect(o.from,o.to)}}}e.SubBackConnectionMutation=v;class T extends n.Mutation{constructor(t=!1){super(),this.mutateOutput=t}mutate(t){const e=this.mutateOutput?t.nodes.filter(t=>void 0!==t&&!t.isInputNode()):t.nodes.filter(t=>void 0!==t&&t.isHiddenNode());if(e.length>=2){const t=s.pickRandom(e),o=s.pickRandom(e.filter(e=>e!==t)),n=t.bias,i=t.squash;t.bias=o.bias,t.squash=o.squash,o.bias=n,o.squash=i}}}e.SwapNodesMutation=T,e.ALL_INSTINCT_MUTATIONS=[new a,new c,new h,new u,new d,new l,new p,new m,new y,new f,new g,new N,new v,new T],e.FEEDFORWARD_INSTINCT_MUTATIONS=[new a,new c,new h,new u,new d,new l,new p,new T],e.NO_STRUCTURE_INSTINCT_MUTATIONS=[new d,new l,new p],e.ONLY_STRUCTURE_INSTINCT_MUTATION=[new a,new c,new h,new u,new m,new y,new f,new g,new N,new v,new T]},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ConstantNode=void 0;const n=o(5),i=o(0);class s extends n.Node{constructor(){super(i.NodeType.HIDDEN),this.bias=1}fromJSON(t){var e;return this.index=null!==(e=t.index)&&void 0!==e?e:-1,this}toJSON(){return super.toJSON()}mutateBias(){throw new ReferenceError("Cannot mutate a pool node!")}mutateActivation(){throw new ReferenceError("Cannot mutate a pool node!")}addGate(){throw new ReferenceError("A pool node can't gate a connection!")}removeGate(){throw new ReferenceError("A pool node can't gate a connection!")}setBias(){throw new ReferenceError("Cannot set the bias of a pool node!")}}e.ConstantNode=s},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ALL_LOSSES=e.HINGELoss=e.MSLELoss=e.WAPELoss=e.MAPELoss=e.MAELoss=e.BinaryLoss=e.MBELoss=e.MSELoss=void 0;const n=o(2);e.MSELoss=(t,e)=>{let o=0;return e.forEach((e,n)=>{o+=Math.pow(t[n]-e,2)}),o/e.length},e.MBELoss=(t,e)=>{let o=0;return e.forEach((e,n)=>{o+=t[n]-e}),o/e.length},e.BinaryLoss=(t,e)=>{let o=0;return e.forEach((e,n)=>{o+=Math.round(2*t[n])!==Math.round(2*e)?1:0}),o/e.length},e.MAELoss=(t,e)=>{let o=0;return e.forEach((e,n)=>{o+=Math.abs(t[n]-e)}),o/e.length},e.MAPELoss=(t,e)=>{let o=0;return e.forEach((e,n)=>{o+=Math.abs((e-t[n])/Math.max(t[n],1e-15))}),o/e.length},e.WAPELoss=(t,e)=>{let o=0;return e.forEach((e,n)=>{o+=Math.abs(t[n]-e)}),o/n.sum(t)},e.MSLELoss=(t,e)=>{let o=0;return e.forEach((e,n)=>{o+=Math.log(Math.max(t[n],1e-15))-Math.log(Math.max(e,1e-15))}),o/e.length},e.HINGELoss=(t,e)=>{let o=0;return e.forEach((e,n)=>{o+=Math.max(0,1-e*t[n])}),o/e.length},e.ALL_LOSSES={MSELoss:e.MSELoss,MBELoss:e.MBELoss,BinaryLoss:e.BinaryLoss,MAELoss:e.MAELoss,MAPELoss:e.MAPELoss,WAPELoss:e.WAPELoss,MSLELoss:e.MSLELoss,HINGELoss:e.HINGELoss}},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GatingType=void 0,function(t){t[t.INPUT=0]="INPUT",t[t.SELF=1]="SELF",t[t.OUTPUT=2]="OUTPUT"}(e.GatingType||(e.GatingType={}))},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PoolNode=void 0;const n=o(8),i=o(2),s=o(0);class r extends n.ConstantNode{constructor(t=s.PoolNodeType.MAX_POOLING){super(),this.poolingType=t,this.receivingNode=null}fromJSON(t){return super.fromJSON(t),this.poolingType=t.poolType,this}activate(){const t=Array.from(this.incoming),e=t.map(t=>t.from.activation*t.weight*t.gain);if(this.poolingType===s.PoolNodeType.MAX_POOLING){const o=i.maxValueIndex(e);this.receivingNode=t[o].from,this.state=e[o]}else if(this.poolingType===s.PoolNodeType.AVG_POOLING)this.state=i.avg(e);else{if(this.poolingType!==s.PoolNodeType.MIN_POOLING)throw new ReferenceError("No valid pooling type! Type: "+this.poolingType);{const o=i.minValueIndex(e);this.receivingNode=t[o].from,this.state=e[o]}}return this.activation=this.squash(this.state,!1)*this.mask,this.poolingType===s.PoolNodeType.AVG_POOLING&&(this.derivativeState=this.squash(this.state,!0)),this.gated.forEach(t=>t.gain=this.activation),this.activation}propagate(t,e={}){var o,n,r;e.momentum=null!==(o=e.momentum)&&void 0!==o?o:0,e.rate=null!==(n=e.rate)&&void 0!==n?n:.3,e.update=null===(r=e.update)||void 0===r||r;const a=Array.from(this.outgoing).map(t=>t.to.errorResponsibility*t.weight*t.gain);this.errorResponsibility=this.errorProjected=i.sum(a)*this.derivativeState,this.poolingType===s.PoolNodeType.AVG_POOLING?this.incoming.forEach(t=>{var o,n;let i=this.errorProjected*t.eligibility;t.xTrace.forEach((t,e)=>{i+=e.errorResponsibility*t}),t.deltaWeightsTotal+=(null!==(o=e.rate)&&void 0!==o?o:.3)*i*this.mask,e.update&&(t.deltaWeightsTotal+=(null!==(n=e.momentum)&&void 0!==n?n:0)*t.deltaWeightsPrevious,t.weight+=t.deltaWeightsTotal,t.deltaWeightsPrevious=t.deltaWeightsTotal,t.deltaWeightsTotal=0)}):this.incoming.forEach(t=>{t.weight=this.receivingNode===t.from?1:0,t.gain=this.receivingNode===t.from?1:0})}toJSON(){return Object.assign(super.toJSON(),{poolType:this.poolingType})}}e.PoolNode=r},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PoolingLayer=void 0;const n=o(4),i=o(3);class s extends n.Layer{constructor(t){super(t)}getDefaultIncomingConnectionType(){return i.ConnectionType.POOLING}connectionTypeisAllowed(){return!0}}e.PoolingLayer=s},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Population=void 0;const n=o(6),i=o(2);e.Population=class{constructor(t,e){this.generation=0,this.populationSize=t,this.networks=this.createNetworks(e.template,e.inputSize,e.outputSize)}evolve(t){for(this.calculateScores(t.fitnessFunction,t.dataset,t.loss);this.generation<t.iterations;)this.sortNetworks(),this.networks=this.breed(t.selection,t.elitism),this.mutate(t.mutations,t.mutationRate,t.mutationAmount,{elitists:t.elitism,maxNodes:t.maxNodes,maxConnections:t.maxConnections,maxGates:t.maxGates,activations:t.activations}),this.calculateScores(t.fitnessFunction,t.dataset,t.loss),this.generation++,t.log&&t.log%this.generation==0&&this.log();const e=this.getBest();return this.networks.forEach(t=>t.score=void 0),e}getBest(){return this.sortNetworks(),this.networks[0]}getRandom(){return i.pickRandom(this.networks)}sortNetworks(){this.networks=this.networks.sort((t,e)=>{if(t.score&&e.score)return e.score-t.score;throw new ReferenceError("Scores not set before sorting network array!")})}createNetworks(t,e,o){const i=[];for(let s=0;s<this.populationSize;s++)if(t)i.push(t.deepCopy());else{if(!e||!o)throw new Error("You must provide either a template network or input and output size!");i.push(new n.Network(e,o,!1))}return i}log(){console.log("Generation: "+this.generation+"; Error: "+this.getBest().score)}calculateScores(t,e,o){if(t)t(this.networks,e);else if(e)for(const t of this.networks)t.score=-t.test(e,o);else{let t=!0;if(this.networks.forEach(e=>{e.score||(t=!1)}),!t)throw new Error("If network scores aren't set, you have to specify a fitness function or a dataset!")}}}},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Connection=void 0;const n=o(2);e.Connection=class{constructor(t,e,o,n){this.from=t,this.to=e,this.id=-1,this.weight=null!=o?o:0,this.gain=1,this.eligibility=0,this.deltaWeightsPrevious=0,this.deltaWeightsTotal=0,this.xTrace=new Map,n?(this.gateNode=n,n.addGate(this)):this.gateNode=null}static fromJSON(t,e){var o;const n=e[t.fromIndex].connect(e[t.toIndex],t.weight);return null===(o=t.xTraces)||void 0===o||o.forEach((t,o)=>{n.xTrace.set(e[o],t)}),n}toJSON(){let t;return this.xTrace.size>0?(t=new Map,this.xTrace.forEach((e,o)=>{null==t||t.set(o.index,e)})):t=null,{fromIndex:this.from.index,toIndex:this.to.index,gateNodeIndex:null===this.gateNode?null:this.gateNode.index,weight:this.weight,xTraces:t}}getInnovationID(){return n.pairing(this.from.index,this.to.index)}}},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ONLY_STRUCTURE_MUTATIONS=e.NO_STRUCTURE_MUTATIONS=e.FEEDFORWARD_MUTATIONS=e.ALL_MUTATIONS=e.Mutation=void 0;const n=o(7);e.Mutation=class{},e.ALL_MUTATIONS=n.ALL_INSTINCT_MUTATIONS,e.FEEDFORWARD_MUTATIONS=n.FEEDFORWARD_INSTINCT_MUTATIONS,e.NO_STRUCTURE_MUTATIONS=n.NO_STRUCTURE_INSTINCT_MUTATIONS,e.ONLY_STRUCTURE_MUTATIONS=n.ONLY_STRUCTURE_INSTINCT_MUTATION},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.NEATPopulation=void 0;const n=o(2),i=o(13),s=o(6),r=o(17);class a extends i.Population{constructor(t,e){var o,n,i,s,r,c,h;super(t,e),this.stagnation=0,this.species=[],this.highScore=-1/0,a.c1=null!==(o=e.c1)&&void 0!==o?o:1,a.c2=null!==(n=e.c1)&&void 0!==n?n:1,a.c3=null!==(i=e.c1)&&void 0!==i?i:1,a.survivorRate=null!==(s=e.survivorRate)&&void 0!==s?s:.5,a.distanceThreshold=null!==(r=e.speciesDistanceThreshold)&&void 0!==r?r:2,a.speciesStagnationLimit=null!==(c=e.speciesStagnationLimit)&&void 0!==c?c:15,a.populationStagnationLimit=null!==(h=e.populationStagnationLimit)&&void 0!==h?h:15}breed(t,e){return this.speciate(),this.calculateScores(),this.species.forEach(t=>t.updateScore()),this.sortSpecies(),this.species[0].highScore>this.highScore?(this.stagnation=0,this.highScore=this.species[0].highScore):(this.stagnation++,this.stagnation>a.populationStagnationLimit&&this.killStalePopulation()),this.cullSpecies(1-a.survivorRate),this.killStaleSpecies(),this.killBadSpecies(),this.reproduce(t)}mutate(t,e,o,n){throw new Error("Not implemented!")}createNetworks(t,e,o){t&&(a.nodeIDs=this.createNodeIDsFromTemplate(t),a.connIDs=this.createConnIDsFromTemplate(t));const n=[];for(let i=0;i<this.populationSize;i++)if(t)n.push(t.deepCopy());else{if(!e||!o)throw new Error("You must provide either a template network or input and output size!");n.push(new s.Network(e,o,!0))}return n}log(){console.log("----------------------------"),console.log("Generation: "+this.generation),console.log("Error: "+this.getBest().score),console.log("Num of species: "+this.species.length);for(const t of this.species)console.log(t.toString())}killStaleSpecies(){this.species=this.species.filter(t=>t.stagnation<a.speciesStagnationLimit)}sortSpecies(){this.species=this.species.sort((t,e)=>t.highScore&&e.highScore?e.highScore-t.highScore:t.highScore?-1:e.highScore?1:0)}createNodeIDsFromTemplate(t){const e=new Map;return t.nodes.filter(t=>t.isInputNode()).forEach(t=>{e.set(a.nodeCounter,a.nodeCounter),t.id=a.nodeCounter,a.nodeCounter++}),t.nodes.filter(t=>t.isOutputNode()).forEach(t=>{e.set(a.nodeCounter,a.nodeCounter),t.id=a.nodeCounter,a.nodeCounter++}),t.nodes.filter(t=>t.isHiddenNode()).forEach(t=>{e.set(a.nodeCounter,a.nodeCounter),t.id=a.nodeCounter,a.nodeCounter++}),e}createConnIDsFromTemplate(t){if(0===a.nodeCounter)throw new ReferenceError("Can't create connection ids without node ids");const e=new Map;return t.connections.forEach(t=>{e.set(n.pairing(t.from.id,t.to.id),a.connCounter),t.id=a.connCounter,a.connCounter++}),e}speciate(){this.species.forEach(t=>t.reset()),this.networks.forEach(t=>{let e=!1;for(const o of this.species)if(o.isCompatible(t)){o.put(t),e=!0;break}e||this.species.push(new r.Species(t))})}cullSpecies(t){this.species.forEach(e=>{e.cull(t),e.fitnessSharing()})}killBadSpecies(){const t=this.sumOfAvgAdjustedFitnessScores();this.species=this.species.filter(e=>e.getAvgAdjustedScore()/t*this.populationSize>=1)}sumOfAvgAdjustedFitnessScores(){let t=0;for(const e of this.species)t+=e.getAvgAdjustedScore();return t}reproduce(t){if(0===this.species.length)throw new RangeError("Species length should never be 0!");const e=this.sumOfAvgAdjustedFitnessScores(),o=[];for(const n of this.species){n.size()>=5&&o.push(n.bestNetwork);const i=n.getAvgAdjustedScore(),s=Math.floor(i/e*this.populationSize-1);for(let e=0;e<s;e++)o.push(n.breed(t))}for(;o.length<this.populationSize;)o.push(this.species[0].breed(t));return this.species=[],o}killStalePopulation(){this.species.length<=2||(this.species=this.species.slice(0,2-this.species.length))}}e.NEATPopulation=a},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Species=void 0;const n=o(6),i=o(16),s=o(2);e.Species=class{constructor(t){this.representative=t,this.members=new Set,this.members.add(t),this.highScore=-1/0,this.score=0,this.avgScore=0,this.stagnation=0,this.bestNetwork=t.deepCopy()}isCompatible(t){return t.distance(this.representative,i.NEATPopulation.c1,i.NEATPopulation.c2,i.NEATPopulation.c3)<i.NEATPopulation.distanceThreshold}put(t){this.members.add(t)}updateScore(t=!0){this.fitnessSharing(),this.score=this.sumScores();let e=-1/0,o=this.representative;this.members.forEach(t=>{t.score&&t.score>e&&(e=t.score,o=t)}),e>this.highScore?(this.highScore=e,this.bestNetwork=o.deepCopy(),this.stagnation=0,this.representative=t?o:s.pickRandom(this.members)):this.stagnation++}sumScores(){let t=0;return this.members.forEach(e=>{if(!e.score)throw new ReferenceError("Network needs score for fitness evaluation!");t+=e.score}),t}getSumAdjustedScores(){let t=0;return this.members.forEach(e=>{if(!e.score)throw new ReferenceError("Network needs score for fitness evaluation!");t+=e.adjustedFitness}),t}getAvgAdjustedScore(){return this.getSumAdjustedScores()/this.members.size}reset(){this.representative=s.pickRandom(this.members),this.members.clear(),this.members.add(this.representative),this.score=0}cull(t=.5,e=!0){const o=this.sortedMembersArray();for(let e=Math.floor(t*this.members.size);e<o.length;e++)this.members.delete(o[e]);e||(this.representative=s.pickRandom(this.members))}breed(t){const e=this.sortedMembersArray();return n.Network.crossover(t.select(e),t.select(e))}size(){return this.members.size}toString(){return"Species={Members: "+this.members.size+"; Score: "+this.score+"}"}sortedMembersArray(){return Array.from(this.members).sort((t,e)=>t.score&&e.score?e.score-t.score:t.score?-1:e.score?1:0)}fitnessSharing(){this.members.forEach(t=>{if(!t.score)throw new ReferenceError("Network needs score for fitness sharing!");t.adjustedFitness=t.score/this.members.size})}}},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.InverseRate=e.ExponentialRate=e.StepRate=e.FixedRate=e.Rate=void 0;class n{constructor(t){this.baseRate=t}}e.Rate=n;e.FixedRate=class extends n{calc(){return this.baseRate}};e.StepRate=class extends n{constructor(t,e=.9,o=100){super(t),this.gamma=e,this.stepSize=o}calc(t){return this.baseRate*Math.pow(this.gamma,Math.floor(t/this.stepSize))}};e.ExponentialRate=class extends n{constructor(t,e=.999){super(t),this.gamma=e}calc(t){return this.baseRate*Math.pow(this.gamma,t)}};e.InverseRate=class extends n{constructor(t,e=.001,o=2){super(t),this.gamma=e,this.power=o}calc(t){return this.baseRate*Math.pow(1+this.gamma*t,-this.power)}}},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TournamentSelection=e.PowerSelection=e.FitnessProportionateSelection=e.Selection=void 0;const n=o(2);class i{}e.Selection=i;e.FitnessProportionateSelection=class extends i{select(t){var e,o,i;let s=0,r=0;for(const n of t)r=Math.min(null!==(e=n.score)&&void 0!==e?e:r,r),s+=null!==(o=n.score)&&void 0!==o?o:0;r=Math.abs(r),s+=r*t.length;const a=n.randDouble(0,s);let c=0;for(const e of t)if(c+=(null!==(i=e.score)&&void 0!==i?i:0)+r,a<c)return e;return n.pickRandom(t)}};e.PowerSelection=class extends i{constructor(t=4){super(),this.power=t}select(t){return t[Math.floor(Math.pow(Math.random(),this.power)*t.length)]}};e.TournamentSelection=class extends i{constructor(t=5,e=.5){super(),this.size=t,this.probability=e}select(t){if(this.size>t.length)throw new Error("Your tournament size should be lower than the population size, please change methods.selection.TOURNAMENT.size");const e=[];for(let o=0;o<this.size;o++)e.push(n.pickRandom(t));e.sort((t,e)=>t.score&&e.score?e.score-t.score:t.score?-1:e.score?1:0);for(let t=0;t<this.size;t++)if(Math.random()<this.probability||t===this.size-1)return e[t];return n.pickRandom(t)}}},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.InputLayer=void 0;const n=o(5),i=o(4),s=o(21),r=o(0),a=o(3);class c extends i.Layer{constructor(t,e={noise:!1}){super(t);for(let e=0;e<t;e++){const t=new n.Node(r.NodeType.INPUT);this.nodes.push(t)}if(e.noise){const e=new s.NoiseLayer(t);e.outputNodes.forEach(t=>this.outputNodes.add(t)),this.connections.push(...i.Layer.connect(this.nodes,e,e.getDefaultIncomingConnectionType()))}else this.nodes.forEach(t=>this.outputNodes.add(t))}getDefaultIncomingConnectionType(){return a.ConnectionType.NO_CONNECTION}connectionTypeisAllowed(t){return t===a.ConnectionType.NO_CONNECTION}}e.InputLayer=c},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.NoiseLayer=void 0;const n=o(1),i=o(4),s=o(22),r=o(3);class a extends i.Layer{constructor(t,e={}){var o;super(t);const i=null!==(o=e.activation)&&void 0!==o?o:n.Identitiy;for(let o=0;o<t;o++)this.inputNodes.add(new s.NoiseNode(e).setActivationType(i));this.outputNodes=this.inputNodes,this.nodes.push(...Array.from(this.inputNodes))}getDefaultIncomingConnectionType(){return r.ConnectionType.ONE_TO_ONE}connectionTypeisAllowed(t){return t===r.ConnectionType.ONE_TO_ONE}}e.NoiseLayer=a},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.NoiseNode=void 0;const n=o(8),i=o(2);class s extends n.ConstantNode{constructor(t={}){super(),this.options=t}activate(){var t,e,o,n;this.prevState=this.state;const s=Array.from(this.incoming).map(t=>t.from.activation*t.weight*t.gain);return this.state=i.avg(s)+i.generateGaussian(null!==(e=null===(t=this.options)||void 0===t?void 0:t.mean)&&void 0!==e?e:0,null!==(n=null===(o=this.options)||void 0===o?void 0:o.deviation)&&void 0!==n?n:2),this.activation=this.squash(this.state,!1)*this.mask,this.derivativeState=this.squash(this.state,!0),this.activation}propagate(t,e={}){var o,n,s;e.momentum=null!==(o=e.momentum)&&void 0!==o?o:0,e.rate=null!==(n=e.rate)&&void 0!==n?n:.3,e.update=null===(s=e.update)||void 0===s||s;const r=Array.from(this.outgoing).map(t=>t.to.errorResponsibility*t.weight*t.gain);this.errorResponsibility=this.errorProjected=i.sum(r)*this.derivativeState,this.incoming.forEach(t=>{var o,n;let i=this.errorProjected*t.eligibility;t.xTrace.forEach((t,e)=>{i+=e.errorResponsibility*t}),t.deltaWeightsTotal+=(null!==(o=e.rate)&&void 0!==o?o:.3)*i*this.mask,e.update&&(t.deltaWeightsTotal+=(null!==(n=e.momentum)&&void 0!==n?n:0)*t.deltaWeightsPrevious,t.weight+=t.deltaWeightsTotal,t.deltaWeightsPrevious=t.deltaWeightsTotal,t.deltaWeightsTotal=0)})}}e.NoiseNode=s},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.OutputLayer=void 0;const n=o(1),i=o(5),s=o(4),r=o(0),a=o(3);class c extends s.Layer{constructor(t,e={}){var o;super(t);const s=null!==(o=e.activation)&&void 0!==o?o:n.Identitiy;for(let e=0;e<t;e++)this.inputNodes.add(new i.Node(r.NodeType.OUTPUT).setActivationType(s));this.nodes.push(...Array.from(this.inputNodes))}connect(){throw new ReferenceError("Could not connect an OutputLayer!")}connectionTypeisAllowed(){return!0}getDefaultIncomingConnectionType(){return a.ConnectionType.ALL_TO_ALL}}e.OutputLayer=c},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DropoutNode=void 0;const n=o(8),i=o(2);class s extends n.ConstantNode{constructor(t){super(),this.probability=t,this.droppedOut=!1}activate(){if(1!==this.incoming.size)throw new RangeError("Dropout node should have exactly one incoming connection!");const t=Array.from(this.incoming)[0];return i.randDouble(0,1)<this.probability?(this.droppedOut=!0,this.state=0):(this.droppedOut=!1,this.state=t.from.activation*t.weight*t.gain,this.state*=1/(1-this.probability)),this.activation=this.squash(this.state,!1)*this.mask,this.gated.forEach(t=>t.gain=this.activation),this.activation}propagate(t,e={}){var o,n,s;e.momentum=null!==(o=e.momentum)&&void 0!==o?o:0,e.rate=null!==(n=e.rate)&&void 0!==n?n:.3,e.update=null===(s=e.update)||void 0===s||s;const r=Array.from(this.outgoing).map(t=>t.to.errorResponsibility*t.weight*t.gain);if(this.errorResponsibility=this.errorProjected=i.sum(r)/(1-this.probability),1!==this.incoming.size)throw new RangeError("Dropout node should have exactly one incoming connection!");const a=Array.from(this.incoming)[0];if(!this.droppedOut){let t=this.errorProjected*a.eligibility;a.xTrace.forEach((e,o)=>{t+=o.errorResponsibility*e}),e.update&&(a.deltaWeightsTotal+=e.rate*t*this.mask+e.momentum*a.deltaWeightsPrevious,a.weight+=a.deltaWeightsTotal,a.deltaWeightsPrevious=a.deltaWeightsTotal,a.deltaWeightsTotal=0)}}fromJSON(t){return super.fromJSON(t),this.probability=t.probability,this}toJSON(){return Object.assign(super.toJSON(),{probability:this.probability})}}e.DropoutNode=s},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ActivationNode=void 0;const n=o(8),i=o(2);class s extends n.ConstantNode{constructor(){super()}activate(){this.prevState=this.state;const t=Array.from(this.incoming).map(t=>t.from.activation*t.weight*t.gain);if(1!==t.length)throw new ReferenceError("Only 1 incoming connections is allowed!");return this.state=t[0],this.activation=this.squash(this.state,!1)*this.mask,this.derivativeState=this.squash(this.state,!0),this.activation}propagate(t,e){var o,n,s;e.momentum=null!==(o=e.momentum)&&void 0!==o?o:0,e.rate=null!==(n=e.rate)&&void 0!==n?n:.3,e.update=null===(s=e.update)||void 0===s||s;const r=Array.from(this.outgoing).map(t=>t.to.errorResponsibility*t.weight*t.gain);this.errorResponsibility=this.errorProjected=i.sum(r)*this.derivativeState,this.incoming.forEach(t=>{var o,n;let i=this.errorProjected*t.eligibility;t.xTrace.forEach((t,e)=>{i+=e.errorResponsibility*t}),t.deltaWeightsTotal+=(null!==(o=e.rate)&&void 0!==o?o:.3)*i*this.mask,e.update&&(t.deltaWeightsTotal+=(null!==(n=e.momentum)&&void 0!==n?n:0)*t.deltaWeightsPrevious,t.weight+=t.deltaWeightsTotal,t.deltaWeightsPrevious=t.deltaWeightsTotal,t.deltaWeightsTotal=0)})}}e.ActivationNode=s},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AvgPooling1DLayer=void 0;const n=o(1),i=o(12),s=o(11),r=o(0);class a extends i.PoolingLayer{constructor(t,e={}){var o;super(t);const i=null!==(o=e.activation)&&void 0!==o?o:n.Identitiy;for(let e=0;e<t;e++)this.inputNodes.add(new s.PoolNode(r.PoolNodeType.AVG_POOLING).setActivationType(i));this.outputNodes=this.inputNodes,this.nodes.push(...Array.from(this.inputNodes))}}e.AvgPooling1DLayer=a},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MinPooling1DLayer=void 0;const n=o(1),i=o(12),s=o(0),r=o(11);class a extends i.PoolingLayer{constructor(t,e={}){var o;super(t);const i=null!==(o=e.activation)&&void 0!==o?o:n.Identitiy;for(let e=0;e<t;e++)this.inputNodes.add(new r.PoolNode(s.PoolNodeType.MIN_POOLING).setActivationType(i));this.outputNodes=this.inputNodes,this.nodes.push(...Array.from(this.inputNodes))}}e.MinPooling1DLayer=a},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MaxPooling1DLayer=void 0;const n=o(1),i=o(12),s=o(0),r=o(11);class a extends i.PoolingLayer{constructor(t,e={}){var o;super(t);const i=null!==(o=e.activation)&&void 0!==o?o:n.Identitiy;for(let e=0;e<t;e++)this.inputNodes.add(new r.PoolNode(s.PoolNodeType.MAX_POOLING).setActivationType(i));this.outputNodes=this.inputNodes,this.nodes.push(...Array.from(this.inputNodes))}}e.MaxPooling1DLayer=a},function(t,e,o){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,o,n){void 0===n&&(n=o),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[o]}})}:function(t,e,o,n){void 0===n&&(n=o),t[n]=e[o]}),i=this&&this.__exportStar||function(t,e){for(var o in t)"default"===o||e.hasOwnProperty(o)||n(e,t,o)};Object.defineProperty(e,"__esModule",{value:!0}),i(o(1),e),i(o(2),e),i(o(13),e),i(o(32),e),i(o(16),e),i(o(7),e),i(o(9),e),i(o(15),e),i(o(18),e),i(o(19),e),i(o(33),e),i(o(34),e),i(o(35),e),i(o(36),e),i(o(37),e),i(o(3),e),i(o(10),e),i(o(0),e),i(o(38),e),i(o(17),e),i(o(5),e),i(o(6),e),i(o(14),e),i(o(39),e),i(o(11),e),i(o(22),e),i(o(24),e),i(o(8),e),i(o(25),e),i(o(4),e),i(o(40),e),i(o(41),e),i(o(42),e),i(o(20),e),i(o(23),e),i(o(21),e),i(o(12),e),i(o(26),e),i(o(27),e),i(o(28),e),i(o(43),e),i(o(44),e),i(o(45),e),i(o(46),e),i(o(47),e),i(o(48),e),i(o(49),e),i(o(50),e)},function(t,e,o){t.exports=o(31)},function(t,e,o){var n,i,s;i=[e],void 0===(s="function"==typeof(n=function(t){"use strict";t.__esModule=!0,t.sort=function(t,e,o,r){if(!Array.isArray(t))throw new TypeError("Can only sort arrays");e?"function"!=typeof e&&(r=o,o=e,e=n):e=n,o||(o=0),r||(r=t.length);var a=r-o;if(!(a<2)){var h=0;if(a<32)return h=i(t,o,r,e),void s(t,o,r,o+h,e);var u=new c(t,e),d=function(t){for(var e=0;t>=32;)e|=1&t,t>>=1;return t+e}(a);do{if((h=i(t,o,r,e))<d){var l=a;l>d&&(l=d),s(t,o,o+l,o+h,e),h=l}u.pushRun(o,h),u.mergeRuns(),a-=h,o+=h}while(0!==a);u.forceMergeRuns()}};var e=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9];function o(t){return t<1e5?t<100?t<10?0:1:t<1e4?t<1e3?2:3:4:t<1e7?t<1e6?5:6:t<1e9?t<1e8?7:8:9}function n(t,n){if(t===n)return 0;if(~~t===t&&~~n===n){if(0===t||0===n)return t<n?-1:1;if(t<0||n<0){if(n>=0)return-1;if(t>=0)return 1;t=-t,n=-n}var i=o(t),s=o(n),r=0;return i<s?(t*=e[s-i-1],n/=10,r=-1):i>s&&(n*=e[i-s-1],t/=10,r=1),t===n?r:t<n?-1:1}var a=String(t),c=String(n);return a===c?0:a<c?-1:1}function i(t,e,o,n){var i=e+1;if(i===o)return 1;if(n(t[i++],t[e])<0){for(;i<o&&n(t[i],t[i-1])<0;)i++;!function(t,e,o){for(o--;e<o;){var n=t[e];t[e++]=t[o],t[o--]=n}}(t,e,i)}else for(;i<o&&n(t[i],t[i-1])>=0;)i++;return i-e}function s(t,e,o,n,i){for(n===e&&n++;n<o;n++){for(var s=t[n],r=e,a=n;r<a;){var c=r+a>>>1;i(s,t[c])<0?a=c:r=c+1}var h=n-r;switch(h){case 3:t[r+3]=t[r+2];case 2:t[r+2]=t[r+1];case 1:t[r+1]=t[r];break;default:for(;h>0;)t[r+h]=t[r+h-1],h--}t[r]=s}}function r(t,e,o,n,i,s){var r=0,a=0,c=1;if(s(t,e[o+i])>0){for(a=n-i;c<a&&s(t,e[o+i+c])>0;)r=c,(c=1+(c<<1))<=0&&(c=a);c>a&&(c=a),r+=i,c+=i}else{for(a=i+1;c<a&&s(t,e[o+i-c])<=0;)r=c,(c=1+(c<<1))<=0&&(c=a);c>a&&(c=a);var h=r;r=i-c,c=i-h}for(r++;r<c;){var u=r+(c-r>>>1);s(t,e[o+u])>0?r=u+1:c=u}return c}function a(t,e,o,n,i,s){var r=0,a=0,c=1;if(s(t,e[o+i])<0){for(a=i+1;c<a&&s(t,e[o+i-c])<0;)r=c,(c=1+(c<<1))<=0&&(c=a);c>a&&(c=a);var h=r;r=i-c,c=i-h}else{for(a=n-i;c<a&&s(t,e[o+i+c])>=0;)r=c,(c=1+(c<<1))<=0&&(c=a);c>a&&(c=a),r+=i,c+=i}for(r++;r<c;){var u=r+(c-r>>>1);s(t,e[o+u])<0?c=u:r=u+1}return c}var c=function(){function t(e,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.array=null,this.compare=null,this.minGallop=7,this.length=0,this.tmpStorageLength=256,this.stackLength=0,this.runStart=null,this.runLength=null,this.stackSize=0,this.array=e,this.compare=o,this.length=e.length,this.length<512&&(this.tmpStorageLength=this.length>>>1),this.tmp=new Array(this.tmpStorageLength),this.stackLength=this.length<120?5:this.length<1542?10:this.length<119151?19:40,this.runStart=new Array(this.stackLength),this.runLength=new Array(this.stackLength)}return t.prototype.pushRun=function(t,e){this.runStart[this.stackSize]=t,this.runLength[this.stackSize]=e,this.stackSize+=1},t.prototype.mergeRuns=function(){for(;this.stackSize>1;){var t=this.stackSize-2;if(t>=1&&this.runLength[t-1]<=this.runLength[t]+this.runLength[t+1]||t>=2&&this.runLength[t-2]<=this.runLength[t]+this.runLength[t-1])this.runLength[t-1]<this.runLength[t+1]&&t--;else if(this.runLength[t]>this.runLength[t+1])break;this.mergeAt(t)}},t.prototype.forceMergeRuns=function(){for(;this.stackSize>1;){var t=this.stackSize-2;t>0&&this.runLength[t-1]<this.runLength[t+1]&&t--,this.mergeAt(t)}},t.prototype.mergeAt=function(t){var e=this.compare,o=this.array,n=this.runStart[t],i=this.runLength[t],s=this.runStart[t+1],c=this.runLength[t+1];this.runLength[t]=i+c,t===this.stackSize-3&&(this.runStart[t+1]=this.runStart[t+2],this.runLength[t+1]=this.runLength[t+2]),this.stackSize--;var h=a(o[s],o,n,i,0,e);n+=h,0!=(i-=h)&&0!==(c=r(o[n+i-1],o,s,c,c-1,e))&&(i<=c?this.mergeLow(n,i,s,c):this.mergeHigh(n,i,s,c))},t.prototype.mergeLow=function(t,e,o,n){var i=this.compare,s=this.array,c=this.tmp,h=0;for(h=0;h<e;h++)c[h]=s[t+h];var u=0,d=o,l=t;if(s[l++]=s[d++],0!=--n)if(1!==e){for(var p=this.minGallop;;){var f=0,g=0,m=!1;do{if(i(s[d],c[u])<0){if(s[l++]=s[d++],g++,f=0,0==--n){m=!0;break}}else if(s[l++]=c[u++],f++,g=0,1==--e){m=!0;break}}while((f|g)<p);if(m)break;do{if(0!==(f=a(s[d],c,u,e,0,i))){for(h=0;h<f;h++)s[l+h]=c[u+h];if(l+=f,u+=f,(e-=f)<=1){m=!0;break}}if(s[l++]=s[d++],0==--n){m=!0;break}if(0!==(g=r(c[u],s,d,n,0,i))){for(h=0;h<g;h++)s[l+h]=s[d+h];if(l+=g,d+=g,0==(n-=g)){m=!0;break}}if(s[l++]=c[u++],1==--e){m=!0;break}p--}while(f>=7||g>=7);if(m)break;p<0&&(p=0),p+=2}if(this.minGallop=p,p<1&&(this.minGallop=1),1===e){for(h=0;h<n;h++)s[l+h]=s[d+h];s[l+n]=c[u]}else{if(0===e)throw new Error("mergeLow preconditions were not respected");for(h=0;h<e;h++)s[l+h]=c[u+h]}}else{for(h=0;h<n;h++)s[l+h]=s[d+h];s[l+n]=c[u]}else for(h=0;h<e;h++)s[l+h]=c[u+h]},t.prototype.mergeHigh=function(t,e,o,n){var i=this.compare,s=this.array,c=this.tmp,h=0;for(h=0;h<n;h++)c[h]=s[o+h];var u=t+e-1,d=n-1,l=o+n-1,p=0,f=0;if(s[l--]=s[u--],0!=--e)if(1!==n){for(var g=this.minGallop;;){var m=0,y=0,N=!1;do{if(i(c[d],s[u])<0){if(s[l--]=s[u--],m++,y=0,0==--e){N=!0;break}}else if(s[l--]=c[d--],y++,m=0,1==--n){N=!0;break}}while((m|y)<g);if(N)break;do{if(0!=(m=e-a(c[d],s,t,e,e-1,i))){for(e-=m,f=1+(l-=m),p=1+(u-=m),h=m-1;h>=0;h--)s[f+h]=s[p+h];if(0===e){N=!0;break}}if(s[l--]=c[d--],1==--n){N=!0;break}if(0!=(y=n-r(s[u],c,0,n,n-1,i))){for(n-=y,f=1+(l-=y),p=1+(d-=y),h=0;h<y;h++)s[f+h]=c[p+h];if(n<=1){N=!0;break}}if(s[l--]=s[u--],0==--e){N=!0;break}g--}while(m>=7||y>=7);if(N)break;g<0&&(g=0),g+=2}if(this.minGallop=g,g<1&&(this.minGallop=1),1===n){for(f=1+(l-=e),p=1+(u-=e),h=e-1;h>=0;h--)s[f+h]=s[p+h];s[l]=c[d]}else{if(0===n)throw new Error("mergeHigh preconditions were not respected");for(p=l-(n-1),h=0;h<n;h++)s[p+h]=c[h]}}else{for(f=1+(l-=e),p=1+(u-=e),h=e-1;h>=0;h--)s[f+h]=s[p+h];s[l]=c[d]}else for(p=l-(n-1),h=0;h<n;h++)s[p+h]=c[h]},t}()})?n.apply(e,i):n)||(t.exports=s)},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.InstinctPopulation=void 0;const n=o(13),i=o(2),s=o(6);class r extends n.Population{constructor(t,e){super(t,e)}breed(t,e){if(e>this.populationSize)throw new RangeError("Can`t evolve! Elitism exceeds population size!");const o=[];for(let t=0;t<e;t++)o.push(this.networks[t]);for(;o.length<this.populationSize;)o.push(this.getOffspring(t));return o}mutate(t,e,o,n){for(let s=n.elitists;s<this.networks.length;s++)if(i.randDouble()<=e)for(let e=0;e<o;e++)this.networks[s].mutateRandom(t,n)}getOffspring(t){const e=t.select(this.networks),o=t.select(this.networks);return s.Network.crossover(e,o)}}e.InstinctPopulation=r},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EvolveOptions=void 0;const n=o(1),i=o(9),s=o(19),r=o(7);e.EvolveOptions=class{constructor(){this.input=1,this.output=1,this.generation=0,this.elitism=1,this.equal=!0,this.clear=!1,this.populationSize=50,this.mutationRate=.6,this.mutationAmount=5,this.selection=new s.FitnessProportionateSelection,this.loss=i.MSELoss,this.mutations=r.FEEDFORWARD_INSTINCT_MUTATIONS,this.activations=Object.values(n.ALL_ACTIVATIONS),this.maxNodes=1/0,this.maxConnections=1/0,this.maxGates=1/0,this.iterations=1e3,this.error=.05}}},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TrainOptions=void 0;const n=o(9),i=o(18);e.TrainOptions=class{constructor(t){this.dataset=t,this.iterations=-1,this.error=-1,this.loss=n.MSELoss,this.dropout=0,this.momentum=0,this.batchSize=this.dataset.length,this.rate=new i.FixedRate(.3),this.log=-1,this.crossValidateTestSize=-1,this.shuffle=!1,this.clear=!1}}},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Architect=void 0;const n=o(20),i=o(23),s=o(4),r=o(6);e.Architect=class{constructor(){this.layers=[]}addLayer(t,e){const o=null!=e?e:t.getDefaultIncomingConnectionType();if(!t.connectionTypeisAllowed(o))throw new ReferenceError("Connection type "+o+" is not allowed at layer "+t.constructor.name);return this.layers.push({layer:t,incomingConnectionType:o}),this}buildModel(){if(!(this.layers[0].layer instanceof n.InputLayer))throw new ReferenceError("First layer has to be a InputLayer! Currently is: "+this.layers[0].layer.constructor.name);if(!(this.layers[this.layers.length-1].layer instanceof i.OutputLayer))throw new ReferenceError("Last layer has to be a OutputLayer! Currently is: "+this.layers[this.layers.length-1].layer.constructor.name);const t=this.layers[0].layer.nodes.length,e=this.layers[this.layers.length-1].layer.nodes.length,o=new r.Network(t,e,!0);o.nodes=[],o.connections.clear();for(let t=0;t<this.layers.length-1;t++)s.Layer.connect(this.layers[t].layer,this.layers[t+1].layer,this.layers[t+1].incomingConnectionType).forEach(t=>o.connections.add(t)),o.nodes.push(...this.layers[t].layer.nodes),this.layers[t].layer.connections.forEach(t=>o.connections.add(t)),this.layers[t].layer.gates.forEach(t=>o.gates.add(t));return o.nodes.push(...this.layers[this.layers.length-1].layer.nodes),o}}},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ActivationLayer=void 0;const n=o(1),i=o(25),s=o(4),r=o(3);class a extends s.Layer{constructor(t,e={}){var o;super(t);const s=null!==(o=e.activation)&&void 0!==o?o:n.Logistic;for(let e=0;e<t;e++)this.inputNodes.add((new i.ActivationNode).setActivationType(s));this.outputNodes=this.inputNodes,this.nodes.push(...Array.from(this.inputNodes))}connectionTypeisAllowed(t){return t===r.ConnectionType.ONE_TO_ONE}getDefaultIncomingConnectionType(){return r.ConnectionType.ONE_TO_ONE}}e.ActivationLayer=a},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DenseLayer=void 0;const n=o(1),i=o(5),s=o(4),r=o(0),a=o(3);class c extends s.Layer{constructor(t,e={}){var o;super(t);const s=null!==(o=e.activationType)&&void 0!==o?o:n.Logistic;for(let e=0;e<t;e++)this.inputNodes.add(new i.Node(r.NodeType.HIDDEN).setActivationType(s));this.outputNodes=this.inputNodes,this.nodes.push(...Array.from(this.inputNodes))}connectionTypeisAllowed(){return!0}getDefaultIncomingConnectionType(){return a.ConnectionType.ALL_TO_ALL}}e.DenseLayer=c},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DropoutLayer=void 0;const n=o(1),i=o(4),s=o(24),r=o(3);class a extends i.Layer{constructor(t,e={}){var o,i;super(t);const r=null!==(o=e.activation)&&void 0!==o?o:n.Identitiy,a=null!==(i=e.probability)&&void 0!==i?i:.1;for(let e=0;e<t;e++)this.inputNodes.add(new s.DropoutNode(a).setActivationType(r));this.outputNodes=this.inputNodes,this.nodes.push(...Array.from(this.inputNodes))}getDefaultIncomingConnectionType(){return r.ConnectionType.ONE_TO_ONE}connectionTypeisAllowed(t){return t===r.ConnectionType.ONE_TO_ONE}}e.DropoutLayer=a},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GlobalAvgPooling1DLayer=void 0;const n=o(26);class i extends n.AvgPooling1DLayer{constructor(t,e={}){super(1,e)}}e.GlobalAvgPooling1DLayer=i},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GlobalMinPooling1DLayer=void 0;const n=o(27);class i extends n.MinPooling1DLayer{constructor(t,e={}){super(1,e)}}e.GlobalMinPooling1DLayer=i},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GlobalMaxPooling1DLayer=void 0;const n=o(28);class i extends n.MaxPooling1DLayer{constructor(t,e={}){super(1,e)}}e.GlobalMaxPooling1DLayer=i},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GRULayer=void 0;const n=o(1),i=o(5),s=o(4),r=o(0),a=o(3),c=o(10);class h extends s.Layer{constructor(t,e={}){super(t);const o=[],h=[],u=[],d=[],l=[];for(let e=0;e<t;e++)this.inputNodes.add(new i.Node(r.NodeType.HIDDEN)),o.push(new i.Node(r.NodeType.HIDDEN).setBias(1)),h.push(new i.Node(r.NodeType.HIDDEN).setBias(0).setActivationType(n.Logistic)),u.push(new i.Node(r.NodeType.HIDDEN).setBias(0)),d.push(new i.Node(r.NodeType.HIDDEN).setActivationType(n.TANH)),l.push(new i.Node(r.NodeType.HIDDEN).setBias(0).setActivationType(n.Logistic)),this.outputNodes.add(new i.Node(r.NodeType.HIDDEN));this.connections.push(...s.Layer.connect(this.inputNodes,o,a.ConnectionType.ALL_TO_ALL)),this.connections.push(...s.Layer.connect(this.inputNodes,u,a.ConnectionType.ALL_TO_ALL)),this.connections.push(...s.Layer.connect(this.inputNodes,d,a.ConnectionType.ALL_TO_ALL)),this.connections.push(...s.Layer.connect(l,o,a.ConnectionType.ALL_TO_ALL)),this.connections.push(...s.Layer.connect(o,h,a.ConnectionType.ONE_TO_ONE,1)),this.connections.push(...s.Layer.connect(l,u,a.ConnectionType.ALL_TO_ALL));const p=s.Layer.connect(l,d,a.ConnectionType.ALL_TO_ALL);this.connections.push(...p),this.gates.push(...s.Layer.gate(u,p,c.GatingType.OUTPUT));const f=s.Layer.connect(l,this.outputNodes,a.ConnectionType.ALL_TO_ALL),g=s.Layer.connect(d,this.outputNodes,a.ConnectionType.ALL_TO_ALL);this.connections.push(...f),this.connections.push(...g),this.gates.push(...s.Layer.gate(o,f,c.GatingType.OUTPUT)),this.gates.push(...s.Layer.gate(h,g,c.GatingType.OUTPUT)),this.connections.push(...s.Layer.connect(this.outputNodes,l,a.ConnectionType.ONE_TO_ONE,1)),this.nodes.push(...Array.from(this.inputNodes)),this.nodes.push(...o),this.nodes.push(...h),this.nodes.push(...u),this.nodes.push(...d),this.nodes.push(...Array.from(this.outputNodes)),this.nodes.push(...l),this.outputNodes.forEach(t=>{var o;return t.squash=null!==(o=e.activation)&&void 0!==o?o:n.Logistic})}connectionTypeisAllowed(){return!0}getDefaultIncomingConnectionType(){return a.ConnectionType.ALL_TO_ALL}}e.GRULayer=h},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.HopfieldLayer=void 0;const n=o(1),i=o(5),s=o(4),r=o(0),a=o(3);class c extends s.Layer{constructor(t){super(t);for(let e=0;e<t;e++)this.inputNodes.add(new i.Node(r.NodeType.HIDDEN)),this.outputNodes.add(new i.Node(r.NodeType.HIDDEN).setActivationType(n.BinaryStep));this.connections.push(...s.Layer.connect(this.inputNodes,this.outputNodes,a.ConnectionType.ALL_TO_ALL)),this.connections.push(...s.Layer.connect(this.outputNodes,this.inputNodes,a.ConnectionType.ALL_TO_ALL)),this.nodes.push(...Array.from(this.inputNodes)),this.nodes.push(...Array.from(this.outputNodes))}connectionTypeisAllowed(){return!0}getDefaultIncomingConnectionType(){return a.ConnectionType.ALL_TO_ALL}}e.HopfieldLayer=c},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.LSTMLayer=void 0;const n=o(1),i=o(5),s=o(4),r=o(0),a=o(3),c=o(10);class h extends s.Layer{constructor(t,e={}){super(t);const o=[],h=[],u=[],d=[];for(let e=0;e<t;e++)this.inputNodes.add(new i.Node(r.NodeType.HIDDEN)),o.push(new i.Node(r.NodeType.HIDDEN).setBias(1)),h.push(new i.Node(r.NodeType.HIDDEN).setBias(1).setActivationType(n.Logistic)),u.push(new i.Node(r.NodeType.HIDDEN)),d.push(new i.Node(r.NodeType.HIDDEN).setBias(1)),this.outputNodes.add(new i.Node(r.NodeType.HIDDEN));this.connections.push(...s.Layer.connect(u,o,a.ConnectionType.ALL_TO_ALL)),this.connections.push(...s.Layer.connect(u,h,a.ConnectionType.ALL_TO_ALL)),this.connections.push(...s.Layer.connect(u,d,a.ConnectionType.ALL_TO_ALL));const l=s.Layer.connect(u,u,a.ConnectionType.ONE_TO_ONE),p=s.Layer.connect(u,this.outputNodes,a.ConnectionType.ALL_TO_ALL);this.connections.push(...l),this.connections.push(...p),this.connections.push(...s.Layer.connect(this.inputNodes,u,a.ConnectionType.ALL_TO_ALL)),this.connections.push(...s.Layer.connect(this.inputNodes,d,a.ConnectionType.ALL_TO_ALL)),this.connections.push(...s.Layer.connect(this.inputNodes,h,a.ConnectionType.ALL_TO_ALL));const f=s.Layer.connect(this.inputNodes,o,a.ConnectionType.ALL_TO_ALL);this.connections.push(...f),this.gates.push(...s.Layer.gate(h,l,c.GatingType.SELF)),this.gates.push(...s.Layer.gate(d,p,c.GatingType.OUTPUT)),this.gates.push(...s.Layer.gate(o,f,c.GatingType.INPUT)),this.nodes.push(...Array.from(this.inputNodes)),this.nodes.push(...o),this.nodes.push(...h),this.nodes.push(...u),this.nodes.push(...d),this.nodes.push(...Array.from(this.outputNodes)),this.outputNodes.forEach(t=>{var o;return t.squash=null!==(o=e.activation)&&void 0!==o?o:n.TANH})}connectionTypeisAllowed(){return!0}getDefaultIncomingConnectionType(){return a.ConnectionType.ALL_TO_ALL}}e.LSTMLayer=h},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MemoryLayer=void 0;const n=o(1),i=o(5),s=o(4),r=o(0),a=o(3);class c extends s.Layer{constructor(t,e={}){var o;super(t);for(let e=0;e<t;e++)this.inputNodes.add(new i.Node(r.NodeType.HIDDEN));let c=Array.from(this.inputNodes);const h=[];for(let u=0;u<(null!==(o=e.memorySize)&&void 0!==o?o:1);u++){const e=[];for(let o=0;o<t;o++){const t=new i.Node(r.NodeType.HIDDEN);t.squash=n.Identitiy,t.bias=0,e.push(t)}this.connections.push(...s.Layer.connect(c,e,a.ConnectionType.ONE_TO_ONE)),h.push(...e),c=e}this.nodes.push(...Array.from(this.inputNodes)),this.nodes.push(...h.reverse()),c.forEach(t=>this.outputNodes.add(t)),this.outputNodes.forEach(t=>{var o;return t.squash=null!==(o=e.activation)&&void 0!==o?o:n.Logistic})}connectionTypeisAllowed(){return!0}getDefaultIncomingConnectionType(){return a.ConnectionType.ALL_TO_ALL}}e.MemoryLayer=c},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RNNLayer=void 0;const n=o(1),i=o(5),s=o(4),r=o(0),a=o(3);class c extends s.Layer{constructor(t,e={}){var o;super(t);for(let s=0;s<t;s++)this.inputNodes.add(new i.Node(r.NodeType.HIDDEN).setActivationType(null!==(o=e.activation)&&void 0!==o?o:n.Logistic));this.outputNodes=this.inputNodes,this.nodes.push(...Array.from(this.inputNodes)),this.connections.push(...s.Layer.connect(this.nodes,this.nodes,a.ConnectionType.ONE_TO_ONE))}connectionTypeisAllowed(){return!0}getDefaultIncomingConnectionType(){return a.ConnectionType.ALL_TO_ALL}}e.RNNLayer=c}]);